<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroCarb ‚Äî Cloud Computing, Zero Guilt</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dark-mode.css">
    <link rel="stylesheet" href="educational.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="dark-mode.js"></script>
    <link rel="icon" href="logo.png" type="image/png">
    <!-- D3.js for interactive map -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/d3-geo.v3.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <!-- Chart.js for forecast visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header-inner">
                    <a href="#" class="logo">
                        <img src="logo.png" alt="ZeroCarb" class="logo-image">
                    </a>
                    <nav class="header-nav">
                        <a href="#stats-insights-section" class="nav-link active" data-section="stats-insights-section">Dashboard</a>
                        <a href="#aws-regions" class="nav-link" data-section="aws-regions" onclick="switchRegionTab('europe')">Europe</a>
                        <a href="#aws-regions" class="nav-link" data-section="aws-regions" onclick="switchRegionTab('worldwide')">Worldwide</a>
                        <a href="#history" class="nav-link" data-section="history">History</a>
                        <a href="#calculator" class="nav-link" data-section="calculator">Calculator</a>
                    </nav>
                    <div class="header-meta">
                        <div class="status">
                            <span class="status-dot live" id="status-dot"></span>
                            <span id="live-count">0 live</span>
                        </div>
                        <span class="text-xs text-grey" id="data-sources-summary" title="Data sources in use">
                            Sources: <span id="sources-list">Loading...</span>
                        </span>
                        <span class="text-xs text-grey">Updated <span id="last-updated-time">--:--</span></span>
                        <button class="beginner-mode-toggle" id="beginner-mode-toggle" onclick="toggleBeginnerMode()" title="Toggle beginner-friendly explanations">
                            <span class="toggle-icon">üìö</span>
                            <span class="toggle-label">Learn</span>
                        </button>
                        <button class="section-action" onclick="openGlossary()" title="Green Software Glossary">Glossary</button>
                        <button class="section-action" onclick="refreshData()">Refresh</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <div class="container">
                
                <!-- Quick Tip for Beginners -->
                <div class="quick-tip-container" id="quick-tip-container">
                    <div class="tip-label">Quick Tip</div>
                    <div id="quick-tip">
                        <span class="tip-icon">üí°</span>
                        <span class="tip-text">Loading tip...</span>
                    </div>
                </div>
                
                <!-- Impact Summary Section -->
                <section class="section" id="impact-summary">
                    <div class="impact-summary-card">
                        <div class="impact-header">
                            <h2 class="impact-title" data-edu="carbonAwareness">Impact Summary</h2>
                        </div>
                        <div class="impact-content">
                            <div class="impact-main-stat">
                                <span class="impact-text">
                                    You've saved roughly <strong id="monthly-carbon-saved">Loading...</strong> this month by shifting tests.
                                </span>
                            </div>
                            <div class="impact-equivalents">
                                <div class="equivalent-item">
                                    <span class="equivalent-text">Equivalent to driving <strong id="equivalent-driving">Loading...</strong> by car.</span>
                                </div>
                                <div class="equivalent-item">
                                    <span class="equivalent-text">Would require <strong id="equivalent-trees">Loading...</strong> growing for a year to absorb.</span>
                                </div>
                            </div>
                            <div class="impact-action">
                                <a href="#history" class="impact-report-link">View Full Impact Report ‚Üí</a>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Combined Stats & Insights Section -->
                <section class="section" id="stats-insights-section">
                    <div class="section-header">
                        <span class="section-title" data-edu="carbonIntensity">Carbon Intelligence Dashboard</span>
                        <span class="text-xs text-muted">Real-time insights and optimization recommendations</span>
                    </div>
                    <div class="insights-grid insights-grid-2">
                        <!-- Combined Region Optimization Tile -->
                        <div class="insight-card insight-card-region-optimizer">
                            <div class="region-optimizer-header">
                                <div class="optimizer-title">
                                    <h3 data-edu="awsRegions">Choose Your Region Wisely</h3>
                                    <p>Different cloud regions have different environmental impacts</p>
                                </div>
                            </div>
                            
                            <div class="region-comparison">
                                <div class="current-selection">
                                    <div class="selection-label">Your Current Choice</div>
                                    <select class="region-selector" id="comparison-region-select" onchange="updateRegionComparison()">
                                        <option value="eu-west-2">eu-west-2</option>
                                        <option value="eu-north-1">eu-north-1</option>
                                        <option value="eu-west-3">eu-west-3</option>
                                        <option value="eu-central-1">eu-central-1</option>
                                        <option value="eu-west-1">eu-west-1</option>
                                        <option value="eu-south-1">eu-south-1</option>
                                        <option value="eu-south-2">eu-south-2</option>
                                        <option value="eu-central-2">eu-central-2</option>
                                    </select>
                                    <div class="region-stats">
                                        <div class="stat-value" id="current-region-intensity">250</div>
                                        <div class="stat-unit">gCO‚ÇÇ/kWh</div>
                                    </div>
                                </div>
                                
                                <div class="vs-indicator">
                                    <span class="vs-text">vs</span>
                                    <div class="arrow-right">‚Üí</div>
                                </div>
                                
                                <div class="best-alternative">
                                    <div class="selection-label">Cleanest Option</div>
                                    <div class="best-region-display">
                                        <div class="best-region-name" id="best-region-name">Stockholm, Sweden</div>
                                    </div>
                                    <div class="region-stats">
                                        <div class="stat-value green" id="best-region-intensity">15</div>
                                        <div class="stat-unit">gCO‚ÇÇ/kWh</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="savings-summary">
                                <div class="savings-badge" id="savings-badge">
                                    <span class="savings-text">
                                        <strong id="savings-percentage">Loading...</strong> less carbon emissions
                                    </span>
                                </div>
                                <div class="savings-explanation" id="savings-explanation">
                                    Loading region comparison data...
                                </div>
                            </div>
                            
                            <div class="action-hint">
                                <span class="hint-text">Choose cleaner regions to reduce your carbon footprint</span>
                            </div>
                        </div>
                        <div class="insight-card insight-card-optimal-time">
                            <div class="optimal-time-header">
                                <div class="optimal-time-badge">
                                    <span class="optimal-badge-text" data-edu="forecast">OPTIMAL TIME TO DEPLOY</span>
                                </div>
                                <select class="optimal-time-region-select" id="optimal-time-region-select" onchange="updateOptimalTimeForRegion()">
                                    <option value="eu-west-2">eu-west-2</option>
                                    <option value="eu-north-1">eu-north-1</option>
                                    <option value="eu-west-3">eu-west-3</option>
                                    <option value="eu-central-1">eu-central-1</option>
                                    <option value="eu-west-1">eu-west-1</option>
                                    <option value="eu-south-1">eu-south-1</option>
                                    <option value="eu-south-2">eu-south-2</option>
                                    <option value="eu-central-2">eu-central-2</option>
                                </select>
                            </div>
                            
                            <div class="optimal-time-main-display">
                                <div class="optimal-time-large" id="optimal-time-text">Loading...</div>
                                <div class="optimal-time-subtitle" id="optimal-time-window">Fetching forecast data...</div>
                            </div>
                            
                            <div class="optimal-time-explanation" id="optimal-time-explanation-section">
                                <div class="explanation-content">
                                    <div class="explanation-title" id="optimal-explanation-title">Analysis</div>
                                    <div class="explanation-text" id="optimal-explanation">Loading forecast analysis...</div>
                                </div>
                            </div>
                            
                            <div class="optimal-time-actions">
                                <button class="btn-schedule" id="btn-schedule" onclick="scheduleOptimalTime()" style="display: none;">
                                    Schedule for <span id="schedule-time">--:--</span>
                                </button>
                            </div>
                            
                            <div class="optimal-time-chart-container">
                                <div class="forecast-chart" id="optimal-time-chart">
                                    <!-- Chart bars will be generated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- AWS Regions Tabbed Section -->
                <section class="section" id="aws-regions">
                    <div class="section-header section-header-collapsible" onclick="toggleSection('aws-regions')">
                        <div>
                            <span class="section-title">AWS Regions</span>
                            <span class="text-xs text-muted">Real-time carbon intensity across AWS data centers</span>
                        </div>
                        <button class="collapse-btn" id="aws-regions-collapse-btn">
                            <span class="collapse-icon">‚àí</span>
                        </button>
                    </div>
                    <div class="section-content" id="aws-regions-content">
                        
                        <!-- Tab Navigation -->
                        <div class="tab-navigation">
                            <button class="tab-btn active" id="europe-tab-btn" onclick="switchRegionTab('europe')">
                                Europe Regions
                            </button>
                            <button class="tab-btn" id="worldwide-tab-btn" onclick="switchRegionTab('worldwide')">
                                Worldwide Regions
                            </button>
                        </div>

                        <!-- Europe Tab Content -->
                        <div class="tab-content active" id="europe-tab-content">
                            <div class="tab-header">
                                <span class="tab-subtitle">gCO‚ÇÇ/kWh ¬∑ Real-time carbon intensity</span>
                            </div>
                            <div class="region-grid" id="region-grid">
                                <!-- Dynamically populated -->
                            </div>
                        </div>

                        <!-- Worldwide Tab Content -->
                        <div class="tab-content" id="worldwide-tab-content">
                            <div class="tab-header">
                                <span class="tab-subtitle">Interactive map ¬∑ Zoom, pan, and hover to explore</span>
                                <div class="view-toggle">
                                    <button class="toggle-btn active" id="map-view-btn" onclick="switchView('map')">Map</button>
                                    <button class="toggle-btn" id="grid-view-btn" onclick="switchView('grid')">Grid</button>
                                </div>
                            </div>
                    
                    <!-- D3.js World Map -->
                    <div id="world-map-container" style="width: 100%; height: 450px; background: #f8f9fa; border-radius: 8px; position: relative;">
                        <svg id="world-map" width="100%" height="450"></svg>
                        <div id="map-tooltip" style="position: absolute; display: none; background: rgba(0,0,0,0.9); color: white; padding: 12px; border-radius: 6px; font-size: 12px; pointer-events: none; z-index: 1000;"></div>
                        
                        <!-- Region Details HUD Panel -->
                        <div id="region-hud" style="position: absolute; top: 20px; left: 20px; width: 320px; background: rgba(255,255,255,0.98); backdrop-filter: blur(10px); border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); display: none; z-index: 999; border: 1px solid rgba(0,0,0,0.1);">
                            <div style="padding: 20px;">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                                    <div>
                                        <div id="hud-flag" style="font-size: 24px; margin-bottom: 4px;"></div>
                                        <div id="hud-region" style="font-size: 18px; font-weight: 700; color: #1f2937;"></div>
                                        <div id="hud-location" style="font-size: 12px; color: #6b7280; margin-top: 2px;"></div>
                                    </div>
                                    <button onclick="closeRegionHUD()" style="background: none; border: none; font-size: 20px; color: #9ca3af; cursor: pointer; padding: 0; line-height: 1;">&times;</button>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                                    <div style="text-align: center;">
                                        <div id="hud-intensity-box" style="background: #f3f4f6; padding: 12px; border-radius: 8px;">
                                            <div id="hud-intensity" style="font-size: 24px; font-weight: 700; font-family: 'SF Mono', monospace;"></div>
                                            <div style="font-size: 9px; color: #6b7280; margin-top: 2px;">gCO‚ÇÇ/kWh</div>
                                        </div>
                                        <div style="font-size: 10px; font-weight: 600; color: #6b7280; margin-top: 6px;">Carbon Intensity</div>
                                    </div>
                                    
                                    <div style="text-align: center;">
                                        <div style="background: #f3f4f6; padding: 12px; border-radius: 8px; position: relative;">
                                            <svg id="hud-carbon-free-ring" width="60" height="60" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);"></svg>
                                            <div id="hud-carbon-free" style="font-size: 18px; font-weight: 700; position: relative; z-index: 1; padding-top: 8px;"></div>
                                        </div>
                                        <div style="font-size: 10px; font-weight: 600; color: #6b7280; margin-top: 6px;">Grid Clean %</div>
                                    </div>
                                    
                                    <div style="text-align: center;">
                                        <div style="background: #f3f4f6; padding: 12px; border-radius: 8px; position: relative;">
                                            <svg id="hud-renewable-ring" width="60" height="60" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);"></svg>
                                            <div id="hud-renewable" style="font-size: 18px; font-weight: 700; position: relative; z-index: 1; padding-top: 8px;"></div>
                                        </div>
                                        <div style="font-size: 10px; font-weight: 600; color: #6b7280; margin-top: 6px;">AWS Renewable</div>
                                    </div>
                                </div>
                                
                                <div id="hud-status-badge" style="text-align: center; padding: 8px; border-radius: 8px; font-size: 12px; font-weight: 600; margin-bottom: 12px;"></div>
                                
                                <div style="font-size: 10px; color: #9ca3af; text-align: center;">
                                    <div id="hud-timestamp"></div>
                                    <div id="hud-source" style="margin-top: 2px;"></div>
                                </div>
                            </div>
                        </div>
                        <div id="map-legend" style="position: absolute; bottom: 20px; right: 20px; background: white; padding: 16px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); font-size: 12px;">
                            <div style="font-weight: 600; margin-bottom: 10px;">Carbon Intensity</div>
                            <div class="legend-item-clickable" data-category="excellent" style="display: flex; align-items: center; margin-bottom: 6px; padding: 4px; border-radius: 4px; cursor: pointer;" onclick="filterByCategory('excellent')">
                                <div style="width: 20px; height: 12px; background: #10b981; border-radius: 2px; margin-right: 8px;"></div>
                                <span>Excellent (‚â§ 25)</span>
                                <span id="count-excellent" style="margin-left: auto; font-weight: 600; color: #10b981;"></span>
                            </div>
                            <div class="legend-item-clickable" data-category="good" style="display: flex; align-items: center; margin-bottom: 6px; padding: 4px; border-radius: 4px; cursor: pointer;" onclick="filterByCategory('good')">
                                <div style="width: 20px; height: 12px; background: #22c55e; border-radius: 2px; margin-right: 8px;"></div>
                                <span>Good (‚â§ 75)</span>
                                <span id="count-good" style="margin-left: auto; font-weight: 600; color: #22c55e;"></span>
                            </div>
                            <div class="legend-item-clickable" data-category="moderate" style="display: flex; align-items: center; margin-bottom: 6px; padding: 4px; border-radius: 4px; cursor: pointer;" onclick="filterByCategory('moderate')">
                                <div style="width: 20px; height: 12px; background: #eab308; border-radius: 2px; margin-right: 8px;"></div>
                                <span>Moderate (‚â§ 150)</span>
                                <span id="count-moderate" style="margin-left: auto; font-weight: 600; color: #eab308;"></span>
                            </div>
                            <div class="legend-item-clickable" data-category="high" style="display: flex; align-items: center; margin-bottom: 6px; padding: 4px; border-radius: 4px; cursor: pointer;" onclick="filterByCategory('high')">
                                <div style="width: 20px; height: 12px; background: #f97316; border-radius: 2px; margin-right: 8px;"></div>
                                <span>High (> 150)</span>
                                <span id="count-high" style="margin-left: auto; font-weight: 600; color: #f97316;"></span>
                            </div>
                            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e5e5;">
                                <button onclick="filterByCategory('all')" style="width: 100%; padding: 6px; border: 1px solid #e5e5e5; background: white; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;">Show All</button>
                            </div>
                        </div>
                        <div id="map-controls" style="position: absolute; top: 20px; right: 20px; background: white; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                            <button onclick="zoomIn()" style="display: block; width: 36px; height: 36px; border: none; background: white; cursor: pointer; font-size: 18px; border-bottom: 1px solid #e5e5e5;">+</button>
                            <button onclick="zoomOut()" style="display: block; width: 36px; height: 36px; border: none; background: white; cursor: pointer; font-size: 18px;">‚àí</button>
                        </div>
                    </div>
                    
                            <!-- Grid View (Hidden by default) -->
                            <div class="global-region-grid" id="global-region-grid" style="display: none;">
                                <!-- Dynamically populated -->
                            </div>
                        </div>
                        
                    </div>
                </section>



                <!-- Excess Power Section -->


                <!-- Enhanced Pipeline History Section -->
                <section class="section" id="history">
                    <div class="section-header">
                        <span class="section-title" data-edu="pipeline">Pipeline History & Analytics</span>
                        <button class="section-action" onclick="exportCSV()">Export CSV</button>
                    </div>
                    
                    <!-- Metrics Overview -->
                    <div class="history-metrics">
                        <div class="metric-card">
                            <div class="metric-label">
                                BASELINE
                                <span class="tooltip-trigger">
                                    <span class="info-icon">i</span>
                                    <div class="tooltip">
                                        <div class="tooltip-title">Baseline Carbon</div>
                                        <div class="tooltip-content">Average carbon emissions from your first 5 pipeline runs, used as reference point.</div>
                                    </div>
                                </span>
                            </div>
                            <div class="metric-value" id="baseline-carbon">--</div>
                            <div class="metric-unit" id="baseline-commits">-- pipelines</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">
                                LATEST
                                <span class="tooltip-trigger">
                                    <span class="info-icon">i</span>
                                    <div class="tooltip">
                                        <div class="tooltip-title">Latest Pipeline</div>
                                        <div class="tooltip-content">Carbon emissions from your most recent pipeline execution.</div>
                                    </div>
                                </span>
                            </div>
                            <div class="metric-value" id="latest-carbon">--</div>
                            <div class="metric-unit" id="latest-commits">-- pipelines</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">
                                TREND
                                <span class="tooltip-trigger">
                                    <span class="info-icon">i</span>
                                    <div class="tooltip">
                                        <div class="tooltip-title">Carbon Trend</div>
                                        <div class="tooltip-content">Overall trend in carbon emissions over recent pipeline runs.</div>
                                    </div>
                                </span>
                            </div>
                            <div class="metric-value trend" id="trend-direction">--</div>
                            <div class="metric-unit" id="trend-change">-- mg/pipeline</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">
                                REGRESSIONS
                                <span class="tooltip-trigger">
                                    <span class="info-icon">i</span>
                                    <div class="tooltip">
                                        <div class="tooltip-title">Carbon Regressions</div>
                                        <div class="tooltip-content">Number of pipelines with significantly higher carbon emissions than baseline.</div>
                                    </div>
                                </span>
                            </div>
                            <div class="metric-value regressions" id="regressions-count">--</div>
                            <div class="metric-unit">detected</div>
                        </div>
                    </div>
                    
                    <!-- Trend Chart -->
                    <div class="history-chart-container">
                        <div class="chart-header">
                            <h3>Energy & Carbon Trend Over Pipelines</h3>
                            <div class="chart-legend">
                                <span class="legend-item">
                                    <span class="legend-dot energy"></span>
                                    Energy
                                </span>
                                <span class="legend-item">
                                    <span class="legend-dot baseline"></span>
                                    Baseline
                                </span>
                            </div>
                        </div>
                        <div class="trend-chart" id="trend-chart">
                            <div class="trend-chart-header">
                                <h4 class="trend-chart-title" data-edu="baseline">Carbon Emissions Trend</h4>
                                <div class="trend-chart-controls">
                                    <label for="trend-pipeline-filter" class="trend-filter-label">Pipeline:</label>
                                    <select id="trend-pipeline-filter" class="trend-pipeline-select" onchange="updateTrendChartAndSync()">
                                        <option value="all">All Pipelines</option>
                                    </select>
                                </div>
                            </div>
                            <canvas id="trend-canvas" width="1000" height="300"></canvas>
                        </div>
                    </div>
                    
                    <!-- Pipeline History -->
                    <div class="pipeline-history">
                        <div class="history-header">
                            <h3>Pipeline History</h3>
                            <div class="history-controls">
                                <div class="history-filters">
                                    <select id="pipeline-filter" onchange="filterHistoryAndSync()">
                                        <option value="all">All Pipelines</option>
                                    </select>
                                    <select id="status-filter" onchange="filterHistory()">
                                        <option value="all">All Status</option>
                                        <option value="optimized">Optimized</option>
                                        <option value="successful">Successful</option>
                                        <option value="failed">Failed</option>
                                        <option value="cancelled">Cancelled</option>
                                    </select>
                                    <select id="region-filter" onchange="filterHistory()">
                                        <option value="all">All Regions</option>
                                        <option value="eu-west-2">eu-west-2</option>
                                        <option value="eu-north-1">eu-north-1</option>
                                        <option value="eu-west-3">eu-west-3</option>
                                    </select>
                                </div>
                                <div class="view-toggle">
                                    <button class="toggle-btn active" id="table-view-btn" onclick="switchHistoryView('table')">Table</button>
                                    <button class="toggle-btn" id="cards-view-btn" onclick="switchHistoryView('cards')">Cards</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Table View (Default) -->
                        <div class="table-container" id="table-view">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Pipeline</th>
                                        <th>Execution ID</th>
                                        <th>Region</th>
                                        <th>Intensity</th>
                                        <th>Duration</th>
                                        <th>Energy</th>
                                        <th>Carbon</th>
                                        <th>vs Baseline</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="history-table">
                                    <!-- Dynamically populated -->
                                </tbody>
                            </table>
                            
                            <!-- Pagination Controls -->
                            <div class="pagination-container" id="pagination-container">
                                <div class="pagination-info">
                                    <span id="pagination-info-text">Showing 1-10 of 0 pipelines</span>
                                </div>
                                <div class="pagination-controls">
                                    <button class="pagination-btn" id="prev-page-btn" onclick="changePage(-1)" disabled>
                                        ‚Üê Previous
                                    </button>
                                    <div class="pagination-pages" id="pagination-pages">
                                        <!-- Page numbers will be generated dynamically -->
                                    </div>
                                    <button class="pagination-btn" id="next-page-btn" onclick="changePage(1)" disabled>
                                        Next ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Cards View -->
                        <div class="commits-table" id="cards-view" style="display: none;">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </section>

                <!-- Carbon Footprint Calculator Section -->
                <section class="section" id="calculator">
                    <div class="section-header">
                        <span class="section-title" data-edu="sci">Carbon Footprint Calculator</span>
                        <span class="text-xs text-muted">Estimate the environmental impact of your cloud workloads</span>
                    </div>
                    
                    <!-- Introduction for beginners -->
                    <div class="calculator-intro">
                        <div class="intro-content">
                            <h3>Why Calculate Carbon Emissions?</h3>
                            <p>Every time you run code in the cloud, it consumes electricity and produces CO‚ÇÇ emissions. Understanding your carbon footprint helps you:</p>
                            <ul class="intro-benefits">
                                <li><strong>Make informed decisions</strong> about where and when to run your workloads</li>
                                <li><strong>Reduce environmental impact</strong> by choosing cleaner regions and optimal timing</li>
                                <li><strong>Track progress</strong> towards sustainability goals</li>
                                <li><strong>Compare options</strong> before deploying applications</li>
                            </ul>
                            <div class="intro-example">
                                <strong>Example:</strong> Running the same workload in Stockholm vs London can reduce emissions by up to 85% due to cleaner electricity sources.
                            </div>
                        </div>
                    </div>

                    <div class="calculator">
                        <div class="calculator-header">
                            <div class="calculator-title">
                                Simple Carbon Calculator
                                <span class="tooltip-trigger">
                                    <span class="info-icon">i</span>
                                    <div class="tooltip">
                                        <div class="tooltip-title">How This Calculator Works</div>
                                        <div class="tooltip-content">This calculator estimates CO‚ÇÇ emissions from your cloud workload using industry-standard methods.</div>
                                        <div class="tooltip-breakdown">
                                            <strong>What we calculate:</strong><br>
                                            ‚Ä¢ Energy consumed by your servers<br>
                                            ‚Ä¢ CO‚ÇÇ emissions from electricity generation<br>
                                            ‚Ä¢ Manufacturing impact of hardware<br>
                                            ‚Ä¢ Data center efficiency factors
                                        </div>
                                        <div class="tooltip-example">
                                            <strong>Based on:</strong><br>
                                            ‚Ä¢ Green Software Foundation standards<br>
                                            ‚Ä¢ Cloud Carbon Footprint methodology<br>
                                            ‚Ä¢ Real-time grid carbon intensity data
                                        </div>
                                    </div>
                                </span>
                            </div>
                            <div class="calculator-subtitle">Enter your workload details below to get an instant carbon footprint estimate</div>
                        </div>
                        <div class="calculator-body">
                            <div class="calc-inputs">
                                <div class="input-group">
                                    <label class="input-label">
                                        Cloud Region
                                        <span class="tooltip-trigger">
                                            <span class="info-icon">i</span>
                                            <div class="tooltip">
                                                <div class="tooltip-title">Why Region Matters</div>
                                                <div class="tooltip-content">Different regions use different energy sources. Some regions use more renewable energy, resulting in lower carbon emissions.</div>
                                                <div class="tooltip-example">
                                                    <strong>Clean regions:</strong> Stockholm (wind/hydro), Paris (nuclear)<br>
                                                    <strong>Higher carbon:</strong> London (gas), Frankfurt (mixed)
                                                </div>
                                            </div>
                                        </span>
                                    </label>
                                    <select class="input-field" id="calc-region">
                                        <option value="eu-north-1">eu-north-1</option>
                                        <option value="eu-west-3">eu-west-3</option>
                                        <option value="eu-central-2">eu-central-2</option>
                                        <option value="eu-west-1">eu-west-1</option>
                                        <option value="eu-central-1">eu-central-1</option>
                                        <option value="eu-west-2" selected>eu-west-2</option>
                                        <option value="eu-south-1">eu-south-1</option>
                                        <option value="eu-south-2">eu-south-2</option>
                                        <option value="us-east-1">us-east-1</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">
                                        How long will it run?
                                        <span class="tooltip-trigger">
                                            <span class="info-icon">i</span>
                                            <div class="tooltip">
                                                <div class="tooltip-title">Runtime Duration</div>
                                                <div class="tooltip-content">Longer running workloads consume more energy and produce more emissions.</div>
                                                <div class="tooltip-example">
                                                    <strong>Examples:</strong><br>
                                                    ‚Ä¢ Unit tests: 5-15 minutes<br>
                                                    ‚Ä¢ Build process: 10-30 minutes<br>
                                                    ‚Ä¢ Integration tests: 30-60 minutes<br>
                                                    ‚Ä¢ Training ML model: hours to days
                                                </div>
                                            </div>
                                        </span>
                                    </label>
                                    <input type="number" class="input-field" id="calc-duration" value="60" min="1" max="10080" placeholder="60">
                                    <span class="input-unit">minutes</span>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">
                                        CPU Cores (vCPUs)
                                        <span class="tooltip-trigger">
                                            <span class="info-icon">i</span>
                                            <div class="tooltip">
                                                <div class="tooltip-title">Virtual CPU Cores</div>
                                                <div class="tooltip-content">More CPU cores = more processing power = more energy consumption.</div>
                                                <div class="tooltip-example">
                                                    <strong>Typical workloads:</strong><br>
                                                    ‚Ä¢ Small app: 1-2 vCPUs<br>
                                                    ‚Ä¢ Web service: 2-4 vCPUs<br>
                                                    ‚Ä¢ Data processing: 4-8 vCPUs<br>
                                                    ‚Ä¢ ML training: 8+ vCPUs
                                                </div>
                                            </div>
                                        </span>
                                    </label>
                                    <input type="number" class="input-field" id="calc-vcpu" value="2" min="1" max="96" placeholder="2">
                                    <span class="input-unit">cores</span>
                                </div>
                                <div class="input-group">
                                    <label class="input-label">
                                        Memory (RAM)
                                        <span class="tooltip-trigger">
                                            <span class="info-icon">i</span>
                                            <div class="tooltip">
                                                <div class="tooltip-title">Memory Usage</div>
                                                <div class="tooltip-content">RAM also consumes electricity, even when not actively processing data.</div>
                                                <div class="tooltip-example">
                                                    <strong>Typical memory:</strong><br>
                                                    ‚Ä¢ Small app: 1-4 GB<br>
                                                    ‚Ä¢ Web service: 4-8 GB<br>
                                                    ‚Ä¢ Database: 8-32 GB<br>
                                                    ‚Ä¢ Big data: 32+ GB
                                                </div>
                                            </div>
                                        </span>
                                    </label>
                                    <input type="number" class="input-field" id="calc-memory" value="4" min="1" max="768" placeholder="4">
                                    <span class="input-unit">GB</span>
                                </div>
                                <div class="input-group full calc-action">
                                    <button class="btn-calculate" onclick="calculateCarbonUI()">
                                        Calculate My Carbon Footprint
                                    </button>
                                </div>
                            </div>
                            <div class="calc-results" id="calc-results">
                                <div class="results-header">
                                    <h4>Your Carbon Footprint</h4>
                                    <p class="results-subtitle">Environmental impact of your workload</p>
                                </div>
                                
                                <div class="result-highlight">
                                    <div class="result-main">
                                        <span class="result-label">Total CO‚ÇÇ Emissions</span>
                                        <span class="result-value-large" id="result-total">-- grams</span>
                                    </div>
                                    <div class="result-comparison" id="result-comparison">
                                        <!-- Dynamic comparison will be added here -->
                                    </div>
                                </div>

                                <div class="result-breakdown">
                                    <div class="breakdown-title">Breakdown</div>
                                    <div class="result-grid">
                                        <div class="result-item">
                                            <div class="result-details">
                                                <span class="result-label">Energy Used</span>
                                                <span class="result-value" id="result-energy">-- kWh</span>
                                            </div>
                                        </div>
                                        <div class="result-item">
                                            <div class="result-details">
                                                <span class="result-label">From Electricity</span>
                                                <span class="result-value" id="result-operational">-- gCO‚ÇÇ</span>
                                            </div>
                                        </div>
                                        <div class="result-item">
                                            <div class="result-details">
                                                <span class="result-label">From Hardware</span>
                                                <span class="result-value" id="result-embodied">-- gCO‚ÇÇ</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="result-actions">
                                    <div class="action-suggestions">
                                        <h5>Ways to Reduce Your Impact</h5>
                                        <ul class="suggestions-list" id="suggestions-list">
                                            <!-- Dynamic suggestions will be added here -->
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-inner">
                    <span class="footer-text">Green QA Platform v2.0 ‚Äî Carbon-Aware Test Scheduling</span>
                    <div class="footer-links">
                        <span class="footer-text">Data: UK National Grid ESO, Ember Climate</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Load global regions data first (for file:// protocol support) -->
    <script src="global-regions-data.js"></script>
    
    <!-- Load test history data (generated by test_e2e_dummy.py) -->
    <script src="test-history-data.js" onerror="console.log('Test history data not found - using sample data')"></script>

    <!-- Region Detail Modal -->
    <div id="region-modal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <div>
                    <div class="modal-title" id="modal-region-name">--</div>
                    <div class="modal-subtitle" id="modal-region-location">--</div>
                </div>
                <button class="modal-close" onclick="closeRegionModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <div class="modal-section-title">Current Carbon Intensity</div>
                    <div class="modal-stat-grid">
                        <div class="modal-stat">
                            <div class="modal-stat-label">Intensity</div>
                            <div class="modal-stat-value accent" id="modal-intensity">--</div>
                        </div>
                        <div class="modal-stat">
                            <div class="modal-stat-label">Index</div>
                            <div class="modal-stat-value" id="modal-index">--</div>
                        </div>
                    </div>
                </div>

                <div class="modal-section" id="modal-recommendations">
                    <div class="modal-section-title">Optimization Recommendations</div>
                    <div id="modal-optimal-badge" style="display: none; padding: 12px; background: #f0fdf4; border: 1px solid #22c55e; margin-bottom: 16px;">
                        <div style="font-size: 13px; font-weight: 600; color: #16a34a; text-transform: uppercase; letter-spacing: 0.06em;">
                            ‚úì Optimal Region ‚Äî Best carbon intensity in Europe
                        </div>
                    </div>
                    <div class="modal-stat-grid">
                        <div class="modal-stat">
                            <div class="modal-stat-label">Optimal Location</div>
                            <div class="modal-stat-value" id="modal-optimal-location" style="font-size: 18px;">--</div>
                        </div>
                        <div class="modal-stat">
                            <div class="modal-stat-label">Potential Savings</div>
                            <div class="modal-stat-value accent" id="modal-savings">--</div>
                        </div>
                    </div>
                    <div id="modal-optimal-time-section" style="margin-top: 16px; display: none;">
                        <div class="modal-info-row">
                            <span class="modal-info-label">Optimal Time (Next 24h)</span>
                            <span class="modal-info-value" id="modal-optimal-time">--</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">Forecast Min Intensity</span>
                            <span class="modal-info-value" id="modal-forecast-min">--</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">Time-Shift Savings</span>
                            <span class="modal-info-value accent" id="modal-timeshift-savings">--</span>
                        </div>
                    </div>
                </div>
                
                <div class="modal-section">
                    <div class="modal-section-title">Region Information</div>
                    <div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">AWS Region</span>
                            <span class="modal-info-value" id="modal-region-id">--</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">Country</span>
                            <span class="modal-info-value" id="modal-country">--</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">Coordinates</span>
                            <span class="modal-info-value" id="modal-coords">--</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">Data Source</span>
                            <span class="modal-info-value" id="modal-source">--</span>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <div class="modal-section-title">Carbon Calculation Factors</div>
                    <div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">PUE (AWS)</span>
                            <span class="modal-info-value">1.135</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">vCPU TDP</span>
                            <span class="modal-info-value">10 Watts</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">Memory Coefficient</span>
                            <span class="modal-info-value">0.000392 kWh/GB¬∑h</span>
                        </div>
                        <div class="modal-info-row">
                            <span class="modal-info-label">Embodied Carbon</span>
                            <span class="modal-info-value">2.5 gCO‚ÇÇ/vCPU¬∑h</span>
                        </div>
                    </div>
                </div>

                <div class="modal-section">
                    <div class="modal-section-title">Methodology References</div>
                    <div style="font-size: 13px; line-height: 1.6; color: var(--grey-700);">
                        <p style="margin-bottom: 8px;"><strong>Cloud Carbon Footprint</strong><br>
                        <a href="https://www.cloudcarbonfootprint.org/docs/methodology/" target="_blank" style="color: var(--accent);">cloudcarbonfootprint.org/docs/methodology</a></p>
                        
                        <p style="margin-bottom: 8px;"><strong>Teads Engineering Research</strong><br>
                        <a href="https://medium.com/teads-engineering/building-an-aws-ec2-carbon-emissions-dataset-3f0fd76c98ac" target="_blank" style="color: var(--accent);">AWS EC2 Carbon Emissions Dataset</a></p>
                        
                        <p style="margin-bottom: 8px;"><strong>Etsy Cloud Jewels</strong><br>
                        <a href="https://github.com/etsy/cloud-jewels" target="_blank" style="color: var(--accent);">github.com/etsy/cloud-jewels</a></p>
                        
                        <p style="margin-bottom: 0;"><strong>Green Software Foundation</strong><br>
                        <a href="https://sci.greensoftware.foundation/" target="_blank" style="color: var(--accent);">SCI Specification</a></p>
                    </div>
                </div>

                <div class="modal-section" id="modal-ember-section">
                    <div class="modal-section-title">About Ember Climate Data</div>
                    <div style="font-size: 14px; line-height: 1.6; color: var(--grey-700);">
                        Ember is a global energy think tank providing yearly electricity data. 
                        This region uses Ember's annual average carbon intensity with realistic 
                        variation (¬±15%) since real-time APIs require authentication.
                    </div>
                </div>

                <div class="modal-section" id="modal-live-section" style="display: none;">
                    <div class="modal-section-title">About UK National Grid ESO</div>
                    <div style="font-size: 14px; line-height: 1.6; color: var(--grey-700);">
                        Real-time carbon intensity data from the UK National Grid Electricity 
                        System Operator. Updated every 30 minutes with actual grid measurements.
                    </div>
                </div>

                <div class="modal-section" id="modal-estimated-section" style="display: none;">
                    <div class="modal-section-title">About Estimated Data</div>
                    <div style="font-size: 14px; line-height: 1.6; color: var(--grey-700);">
                        This data is estimated using ElectricityMaps' TEST MODE. For production 
                        use with real-time data, upgrade to a production API token at 
                        <a href="https://app.electricitymaps.com/" target="_blank" style="color: var(--accent);">app.electricitymaps.com</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Glossary Panel -->
    <div class="glossary-panel" id="glossary-panel">
        <div class="glossary-header">
            <span class="glossary-title">Green Software Glossary</span>
            <button class="glossary-close" onclick="closeGlossary()">√ó</button>
        </div>
        <div class="glossary-search">
            <input type="text" id="glossary-search-input" placeholder="Search terms..." oninput="filterGlossary(this.value)">
        </div>
        <div class="glossary-content" id="glossary-content">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <!-- Real Data API (NO MOCKING) -->
    <script src="real-data-api.js"></script>
    
    <!-- Educational Features -->
    <script src="educational-tooltips.js"></script>
    
    <!-- Test History Data (generated by test_real_pipeline.py) -->
    <script src="test-history-data.js"></script>
    
    <!-- Main Application -->
    <script src="app.js?v=20251215"></script>
</body>
</html>
